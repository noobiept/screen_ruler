image: python:3.7
pipelines:
    default:
        - step:
            script:
                # install dependencies
                - apt-get update
                - apt-get --yes install zip
                - apt-get --yes install jq
                - pip3 install -r requirements.txt

                # run some checks
                - python package.py checkFormat

                # build the application (will create a .zip file on the root directory)
                - python package.py build
                - BUILD_NAME=$(python package.py getBuildName)

                # upload to the 'downloads' section of the bitbucket project
                - curl -X POST "https://${BB_AUTH_STRING}@api.bitbucket.org/2.0/repositories/drk4/screen_ruler/downloads" --form files=@"$BUILD_NAME"
